"use strict";

const sha1 = require("sha1");
const RegDOrder = require("regd-order");
const WebViewManager = require("regd-wvmgr");

var RegD = function(div) {
	this.netid = false;
	this.password = false;
	this.div = div;

	let doc = this.div.ownerDocument;
	this.div.className = "panel panel-warning";
	this.div.id="client-"+netid;

	let header = doc.createElement("div");
	header.className = "panel-heading";
	header.innerHTML = `<h3 class="panel-title">${netid}</h3>`;
	this.div.appendChild(header);

	let body = doc.createElement("div");
	body.className = "panel-body";
	// Fill body

	let status = doc.createElement("div");
	status.className = "alert alert-info";
	status.innerText = "Initializing...";
	this.statusDiv = status;
	body.appendChild(status);

	let webview = doc.createElement("webview");
	// Initialize webview
	webview.partition = "wvctx-"+netid;

	this.webview = webview;
	body.appendChild(webview);

	this.wvmgr = new WebViewManager(this);

	this.div.appendChild(body);

	this.queryAvailability = function(dept, num) {
		return this.webview.getCourseSeats(dept, num);
	};

	this.executeAdd = function(sections) {
		return Promise.resolve().then(() => {

		});
	};
	this.executeDrop = function(sections) {
		return Promise.resolve().then(() => {

		});
	};

	return this;
}

module.exports = RegD;
